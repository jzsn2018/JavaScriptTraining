<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>完善测试工具</title>
</head>
<body>
	<style>
		#regexp{width: 650px;margin-top: 100px;font-size: 14px;}
		#regexp .title{color: #777;font-size: 24px;text-align: center;margin-bottom: 20px}
		#regexp .textbox{height: 160px;border: 1px solid #ccc;border-radius: 5px;padding: 5px;width: 638px;resize: none;}
		#regexp .textfield{width: 215px;padding: 5px;border: 1px solid #ccc;}
		.special,input[type]{font-size: 14px}
		textarea[disabled]{margin-top:10px;}
		.right{color: rgb(26,173,25);font-weight: bold;}
		.error{color: rgb(230,67,64);font-weight: bold;}
		#regexp .readonly{background-color: #eee;}
		#regexp{float: left;}#reglist{float: left;margin:100px 0 0 40px;}#wrap{width: 1050px; height: 840px;margin:0 auto;}
		#both{clear: both;}
		a{text-decoration: none;}dl,dd,h1{margin: 0;padding: 0}#reglist{background-color: #e3e3e3;width: 200px;height:500px;text-indent: 20px;}body,textarea{font-family: 
	'pingfang SC','helvetica neue',arial,'hiragino sans gb','microsoft yahei ui','microsoft yahei',simsun,sans-serif}b{color: red;font-size: 20px}dd,p,button,input{font-size: 20px}
	</style>
</head>
<body>
<div id="wrap">
	<div id="regexp">
			<h1 class="title">正则表达式测试工具</h1>
			<textarea id="userText" placeholder="请在此输入待匹配的文本" class="textbox"></textarea>
			<p class="special">
				正则表达式：
				<input type="text" id="userRegExp" class="textfield" placeholder="在此输入正则表达式">
				<input type="checkbox" name='userModifier' value="i"/>忽略大小写
				<input type="checkbox" name='userModifier' value="g"/>全局匹配
				<input type="checkbox" name='userModifier' value="m"/>多行匹配
				<input type="button" value="测试匹配" id="matchingBtn">
			</p>
			匹配结果：<div id="matchingResult" class="textbox readonly"></div>
			<p class="special">
				将匹配的结果替换成：
				<input type="text" id="userReplaceText" class="textfield" placeholder="在此输入替换文本">
				<input type="button" value="替换文本" id="replaceTextBtn">
			</p>
			替换结果：<div id="replaceResult" class="textbox readonly"></div>
	</div>
	<div id="reglist">
			<h1><b>常用正则表达式</b></h1>
			<dd><a href="javascript:void(0)" title="[\u4e00-\u9fa5]">1_匹配中文字符</a></dd>
			<dd><a href="javascript:void(0)" title="^[1-9]\d{4,10}$">2_匹配QQ号码</a></dd>
			<dd><a href="javascript:void(0)" title="^\S{6,16}$">3_密码验证</a></dd>
			<dd><a href="javascript:void(0)" title="^\s+|\s+$">4_去除首尾空白</a></dd>
			<dd><a href="javascript:void(0)" title="^\d+$">5_正整数</a></dd>
			<dd><a href="javascript:void(0)" title="^-?\d+$">6_负整数</a></dd>
			<dd><a href="javascript:void(0)" title="^\d*\.?\d+$">7_正数字(浮点)正则</a></dd>
			<dd><a href="javascript:void(0)" title="^-\d*\.?\d+$">8_负数字(浮点)正则</a></dd>
			<dd><a href="javascript:void(0)" title="^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$">9_email正则</a></dd>
			<dd><a href="javascript:void(0)" title="^[\u4e00-\u9fa5a-zA-Z0-9_]{2,18}$">10_验证用户昵称</a></dd>
			<dd><a href="javascript:void(0)" title="^[1][3-9][0-9]{9}$">11_手机号码正则</a></dd>
			<dd><a href="javascript:void(0)" title="^[1-9]\d{5}(18|19|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$">13_身份证号码正则</a></dd>
			<dd><a href="javascript:void(0)" title="^((https?|ftp|file):\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$">14_URL正则</a></dd>
			<dd><a href="javascript:void(0)" title="^[a-zA-Z]([-_a-zA-Z0-9]{5,19})+$">15_微信号正则</a></dd>
			<dd><a href="javascript:void(0)" title="^[京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]{1}[A-Z]{1}[A-Z0-9]{4}[A-Z0-9挂学警港澳]{1}$">16_车牌号正则</a></dd>
	</div>
</div>
<script>
		var userText = document.getElementById('userText'),
			userRegExp = document.getElementById('userRegExp'),
			userModifier = document.getElementsByName('userModifier'),
			matchingResult = document.getElementById('matchingResult'),
			matchingBtn = document.getElementById('matchingBtn'),
			pattern = null,
			// modifier = '';//这里的初始值不能设置null，是因为一开始如果没有点击复选框的话，modifier的值就是null new RegExp()接收了一个null的修饰符就会报错
			modifier = '',
			userReplaceText = document.getElementById('userReplaceText'),
			replaceTextBtn = document.getElementById('replaceTextBtn'),
			replaceResult = document.getElementById('replaceResult'),
			reglist = document.getElementById('reglist');
			// 为一组节点添加事件就是要想到循环
			for (var i = 0; i < userModifier.length; i++) {
				userModifier[i].onclick = function () {
					console.log(modifier);
					modifier='';//这里设置为空的原因是：如果不设置空的话，每次复选框的点击就会使modifier一直累加下去
					for (var j = 0; j < userModifier.length; j++) {
						if (userModifier[j].checked) {
							// 每次点击会把modifier清空，再将选中的复选框进行累加
							modifier += userModifier[j].value;
						}
					}
				}
				console.log(modifier);
			}
		matchingBtn.onclick=function () {
			if (!userRegExp.value) {
				matchingResult.innerHTML = '系统检测您未填写正则表达式!';
				matchingResult.className = 'error textbox readonly';
				userRegExp.focus();//将光标定位到相应的dom上
				return;
			}
			if (!userText.value) {
				matchingResult.innerHTML = '系统检测您未填写待匹配文本!';
				matchingResult.className = 'error textbox readonly';
				userText.focus();
				return;
			}

			console.log(modifier);
			pattern = new RegExp('('+userRegExp.value+')',modifier);
			if (pattern.exec(userText.value)) {
				matchingResult.innerHTML = '匹配成功，您的匹配结果为：'+userText.value.replace(pattern,"<span style='background-color:yellow;color:black'>$1</span>");
				matchingResult.className = 'right textbox readonly';
			}else{
				matchingResult.innerHTML ='匹配失败,您需要检测的内容中没有您要找寻的内容';
				matchingResult.className = 'error textbox readonly';
			}
	
		};
		replaceTextBtn.onclick=function () {
			console.log(pattern);
			if (!userReplaceText.value) {
				replaceResult.innerHTML = '系统检测您未填写替换的内容!';
				replaceResult.className = 'error textbox readonly';
				userReplaceText.focus();
				return;
			};
			pattern = new RegExp('('+userRegExp.value+')',modifier);
			replaceResult.innerHTML = "<strong style='color:red'>替换成功</strong>："+userText.value.replace(pattern,function () {
				replaceResult.className = 'right textbox readonly';
				return "<span style = 'background-color:yellow;color:black'>"+userReplaceText.value+'</span>'
			})
			console.log(pattern);
		}
		// DOM2级事件
		reglist.addEventListener('click',function (e) {
			userRegExp.value = '';
			userRegExp.value = e.target.title;
		})
	</script>
</body>
</html>
